
\chapter{Wyniki optymalizacji toru przejazdu}
\label{cha:wyniki}

W tym rozdziale zostan± pokazane wyniki jakie zosta³y otrzymane jako efekt dzia³ania algorytmu ewolucyjnego w celu znalezienia optymalnej trasy przejazdu. Zostanie sprawdzone jak poszczególne parametry algorytmu wp³ywaj± na czas jego dzia³ania oraz uzyskiwane wyniki. Spróbujemy tak¿e rozwi±zaæ problem dla trudniejszych przypadków: zwiêkszaj±c liczbê punktów, które stanowi± rozwi±zanie oraz optymalizuj±c trasê d³u¿szego slalomu. Nastêpnie zostanie przedstawione jak optymalizacja lokalna wp³ywa na czas wykonania programu.

We wstêpie do rozdzia³u \ref{cha:wynikiWeryfikacji} zosta³y opisane wszystkie oznaczenia i sta³e zastosowane w eksperymentach.

%---------------------------------------------------------------------------

\section{Algorytm ewolucyjny}
\label{sec:ewolucyjnyWyniki}
Wiedz±c, ¿e za³o¿enia dotycz±ce modelu oraz sposób poruszania siê narciarza mo¿na uznaæ za poprawne i zbli¿one do tego co rzeczywi¶cie dzieje siê podczas jazdy na stoku, zostanie teraz przetestowane, jak sprawdza siê algorytm ewolucyjny do celów optymalizacji trasy slalomu.

W poni¿szych eksperymentach wykorzystane zostanie nastêpuj±ce ustawienie bramek: (5,13), (0,26), (5,39), (4,44), (11,57), (0,70). Ustawienie to jest podobne do tych, które s± wybierane w rzeczywisto¶ci. Posiada tak¿e wertikal - figurê slalomow± - szerzej opisan± w sekcji \ref{sec:alpineSkiing}, czêsto stosowan± w slalomie, która ma wymuszaæ zmianê rytmu, a wiêc bêdzie dobrym sprawdzianem dla zastosowanego algorytmu.

Zak³adamy, ¿e narciarz startuj±c ma prêdko¶æ pocz±tkow± $1\frac{m}{s}$. Wynika to z tego, ¿e przy starcie zawodnicy zaczynaj± od odepchniêcia siê kijami od ¶niegu nadaj±c sobie prêdko¶æ pocz±tkow±. Najwa¿niejsze jest to, ¿e warto¶æ ta bêdzie sta³a dla wszystkich eksperymentów.

W eksperymencie \ref{sec:lamana} zosta³o stwierdzone, ¿e odleg³o¶ci w pionie pomiêdzy kolejnymi punktami wyznaczaj±cymi trasê powinna wynosiæ 2-4 m. Zatem przyjmijmy, ¿e bêd± to 3 m, co dla wy¿ej podanego slalomu daje nam nieca³e 30 punktów do optymalizacji.

Warto¶ci parametrów algorytmu ewolucyjnego s± takie, jak wymienione wcze¶niej w rozdziale \ref{sec:ewolucyjnyRozw}. Wykorzystany zosta³ algorytmu $(\mu + \lambda)$, gdzie $\mu = 30$, a $\lambda = 100$. W ka¿dej iteracji najpierw krzy¿owane s± osobniki z populacji tymczasowej, losuj±c pary rodzicielskie, a w wyniku krzy¿owania powstaje znów 100 osobników. Nastêpnie mutacji podlegaj± wszystkie z tych osobników. Jedynym dodatkowym za³o¿eniem jest nie zmienianie pozycji punktów przejazdu przez bramki - narciarz ma przeje¿d¿aæ zawsze jak najbli¿ej bramki. Je¶li która¶ z warto¶ci lub zastosowanych algorytmów zmienia siê, jest to zaznaczone w eksperymencie.


\subsubsection{Warunek zakoñczenia}
Warunkiem stopu w zastosowanym algorytmie ewolucyjnym jest sprawdzenie, czy populacja, na której dzia³amy przesta³a byæ ju¿ zró¿nicowana. Dodatkowo, je¶li ró¿nica pomiêdzy najlepszym a najgorszym osobnikiem jest ma³a, czekamy przez okre¶lon± liczbê iteracji, aby sprawdziæ, czy uzyskujemy jeszcze jak±¶ poprawê najlepszego osobnika, ale wiêksz± ni¿ zadana granica. Je¶li taka sytuacja nie zachodzi, oznacza to, ¿e szanse na poprawê wyniku s± niewielkie i mo¿na zakoñczyæ dzia³anie algorytmu. W rozwi±zaniu tym istniej± jednak trzy parametry, których wp³yw na ostateczny wynik zosta³ zbadany w tym eksperymencie. 

\paragraph{Eksperyment 1.} W pierwszym eksperymencie parametry zakoñczenia algorytmu wynosz±:
\begin{itemize}
\item dla zró¿nicowania populacji przyjmujemy na pocz±tek warto¶æ 0.1, czyli 10\%, gdzie warto¶æ ta obliczana jest na podstawie najlepszej i najgorszej warto¶ci fitness w populacji, poprzez znalezienie ró¿nicy tych warto¶ci i podzielenie otrzymanej warto¶ci przez warto¶æ najlepsz± (aby uzyskaæ warto¶æ w \% mno¿ymy przez 100\%),
\item zmiana najlepszego osobnika jest uznawana za wystarczaj±co du¿±, je¶li wyniesie przynajmniej 0.3 s,
\item liczba iteracji, przez które czekamy na zmianê najlepszego osobnika, to na pocz±tek 7.
\end{itemize}

W zwi±zku z tym, ¿e zachowanie algorytmu jest niedeterministyczne, dla ka¿dego zestawu parametrów zosta³y przeprowadzone po trzy eksperymenty, aby mo¿na by³o u¶redniæ wyniki i porównaæ eksperymenty miêdzy sob±.

Poni¿ej (rysunki \ref{fig:w1s} oraz \ref{fig:w1w}) znajduj± siê wyniki wizualne przeprowadzonego eksperymentu. Na kolejnych obrazkach widoczne s± odpowiednio wszystkie trzy znalezione najlepsze trasy oraz wykresy zmian warto¶ci fitness odpowiednio: najlepszego osobnika w ka¿dej iteracji (kolor czerwony), najgorszego osobnika (kolor zielony) oraz ¶rednia warto¶æ fitness ca³ej populacji (kolor niebieski). Kolejno¶æ slalomów odpowiada kolejno¶ci wykresów.

\newpage
\begin{figure}[H]
\centering
\includegraphics[scale=0.8]{wyniki/wynik1-s}
\caption{Wyniki z kolejnych prób dla parametrów zakoñczenia: 10\%, 0.3 s i 7}
\label{fig:w1s}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[scale=0.5]{wyniki/wynik1-w}
\caption{Wykresy z kolejnych prób dla parametrów zakoñczenia: 10\%, 0.3 s i 7}
\label{fig:w1w}
\end{figure}

\newpage
Oto otrzymane czasy przejazdu dla kolejnych prób:

\begin{table}[H]
\caption{Czasy przejazdu dla kolejnych prób wraz z liczb± iteracji oraz czasem dzia³ania algorytmu}
\centering
\begin{tabular}{ | c | c | c | c |}
  \hline                        
  numer próby & czas przejazdu [s] & liczba iteracji & czas dzia³ania [s] \\ \hline  
1 & 7.968 & 7 & 18 \\ \hline
2 & 8.039 & 7 & 19 \\ \hline
3 & 7.917 & 9 & 21 \\ \hline
\end{tabular}
\end{table}

Zatem ¶redni czas przejazdu w tych trzech próbach wyniós³ 7.975 s.

Liczba iteracji w przypadku tych wyników wynios³a 7-9. Algorytm bardzo szybko dochodzi³ do rozwi±zania, a czas dzia³ania to tylko ok. 20 s. Nale¿y zwróciæ uwagê, ¿e bior±c pod uwagê rozproszony model prowadzenia obliczeñ, czas dzia³ania algorytmu mo¿e byæ znacz±co wyd³u¿any - tak by narzuty na komunikacjê i zarz±dzanie wysy³anymi zadaniami nie by³y znacz±c± czê¶ci± czasu wykonania. 

Jednocze¶nie, co obserwujemy na rysunkach, wyniki nie s± satysfakcjonuj±ce - trasa przejazdu nie jest g³adka i z pewno¶ci± istnieje lepsze rozwi±zanie. Jednak skoro zosta³o wykonanych tylko kilka iteracji algorytmu, oznacza to, ¿e mo¿na spróbowaæ uzyskaæ lepsze wyniki poprzez wyd³u¿enie czasu dzia³ania algorytmu.

\paragraph{Eksperyment 2.} W tym eksperymencie zosta³a wprowadzona zmiana w warto¶ci parametru oznaczaj±cego ró¿nicê w fitness najlepszego osobnika. Zamiast warto¶ci 0.3 s u¿yto 0.1 s. Sprawdzone zosta³o zarówno, czy czas dzia³ania algorytmu siê wyd³u¿a jak i czy uda siê przez to otrzymaæ lepszy wynik.

Na rysunkach \ref{fig:w2s} oraz \ref{fig:w2w} a tak¿e w tabeli \ref{tab:tab2} zebrane s± wyniki eksperymentu.

\begin{table}[H]
\caption{Czasy przejazdu dla kolejnych prób wraz z liczb± iteracji oraz czasem dzia³ania algorytmu}
\label{tab:tab2}
\centering
\begin{tabular}{ | c | c | c | c |}
  \hline                        
  numer próby & czas przejazdu [s] & liczba iteracji & czas dzia³ania [s] \\ \hline  
1 & 7.916 & 15 & 49 \\ \hline
2 & 7.809 & 14 & 46 \\ \hline
3 & 7.777 & 16 & 51 \\ \hline
\end{tabular}
\end{table}

¦rednia uzyskanych czasów przedstawionych w tabeli \ref{tab:tab2} wynosi: 7.834 s.

\newpage
\begin{figure}[H]
\centering
\includegraphics[scale=0.9]{wyniki/wynik2-s}
\caption{Wyniki z kolejnych prób dla parametrów zakoñczenia: 10\%, 0.1 s i 7}
\label{fig:w2s}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[scale=0.7]{wyniki/wynik2-w}
\caption{Wykresy z kolejnych prób dla parametrów zakoñczenia: 10\%, 0.1 s i 7}
\label{fig:w2w}
\end{figure}

\newpage
Wyniki poprawi³y siê, linia przejazdu jest du¿o g³adsza, a czasy poprawi³y siê o ok. 0.15 s, czyli o ok. 2\%. Jednak czas dzia³ania algorytmu wyd³u¿y³ siê do 45-50 s, a liczba iteracji wynios³a 14-16. Oczywi¶cie czas ten jest wci±¿ na tyle ma³y, ¿e mo¿emy wprowadzaæ dalsze zmiany, które wyd³u¿± czas dzia³ania i jednocze¶nie umo¿liwi± znalezienie lepszego rozwi±zania.

\paragraph{Eksperyment 3.} W takim razie zdecydowano zmieniæ równie¿ parametr dotycz±cy zró¿nicowania populacji - zamiast 10\%, w tym eksperymencie wynosi on 1\%.

Poni¿ej znajduj± siê zebrane wyniki w tabeli \ref{tab:tab3} oraz na rysunkach \ref{fig:w3s} oraz \ref{fig:w3w}.

\begin{table}[H]
\caption{Czasy przejazdu dla kolejnych prób wraz z liczb± iteracji oraz czasem dzia³ania algorytmu}
\centering
\label{tab:tab3}
\begin{tabular}{ | c | c | c | c |}
  \hline                        
  numer próby & czas przejazdu [s] & liczba iteracji & czas dzia³ania [s] \\ \hline  
1 & 7.818 & 17 & 55 \\ \hline
2 & 7.822 & 14 & 45 \\ \hline
3 & 7.817 & 14 & 47 \\ \hline
\end{tabular}
\end{table}

¦rednia zmierzonych wyników wynosi: 7.819 s.

\begin{figure}[H]
\centering
\includegraphics[scale=0.9]{wyniki/wynik3-s}
\caption{Wyniki dla kolejnych prób eksperymentu dla parametrów zakoñczenia: 1\%, 0.1 s i 7}
\label{fig:w3s}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[scale=0.7]{wyniki/wynik3-w}
\caption{Wykresy dla kolejnych prób eksperymentu dla parametrów zakoñczenia: 1\%, 0.1 s i 7}
\label{fig:w3w}
\end{figure}

Jak widaæ wyniki s± niewiele lepsze ni¿ te poprzednie. Zatem ten warunek praktycznie nie zmieni³ zachowania. Pozosta³ natomiast jeszcze warunek liczby iteracji, przez które sprawdzane jest, czy poprawia siê fitness najlepszego osobnika.

\paragraph{Eksperyment 4.} Zmieniamy teraz warto¶æ liczby iteracji, przez które czekamy na zmianê najlepszego osobnika z 7 na 10.

\begin{table}[H]
\caption{Czasy przejazdu dla kolejnych prób wraz z liczb± iteracji oraz czasem dzia³ania algorytmu}
\centering
\label{tab:tab4}
\begin{tabular}{ | c | c | c | c |}
  \hline                        
  numer próby & czas przejazdu [s] & liczba iteracji & czas dzia³ania [s] \\ \hline  
1 & 7.892 & 13 & 41 \\ \hline
2 & 7.743 & 19 & 60 \\ \hline
3 & 7.837 & 13 & 41 \\ \hline
\end{tabular}
\end{table}

¦rednia wyników wynosi: 7.824 s. Warto zwróciæ uwagê, ¿e ¶rednio w ka¿dym eksperymencie wykonywanych jest 1950 symulacji. Zale¿y to od liczby osobników w populacji oraz populacji tymczasowej, a wiêc parametrów $\mu$ (30) i $\lambda$ (100), a tak¿e od liczby iteracji wykonywanych w ka¿dym eksperymencie (¶rednio: 15 iteracji, a zatem (30 + 100) * 15 = 1950).

\begin{figure}[H]
\centering
\includegraphics[scale=0.7]{wyniki/wynik4-w}
\caption{Wykresy dla kolejnych prób eksperymentu dla parametrów zakoñczenia: 1\%, 0.1 s i 10}
\label{fig:w4w}
\end{figure}

\newpage
\begin{figure}[H]
\centering
\includegraphics[scale=0.9]{wyniki/wynik4-s}
\caption{Wyniki dla kolejnych prób eksperymentu dla parametrów zakoñczenia: 1\%, 0.1 s i 10}
\label{fig:w4s}
\end{figure}

Jak widaæ, równie¿ zmiana tego parametru nie wnios³a poprawy, choæ uda³o siê otrzymaæ dotychczas najlepszy wynik - 7.743 s. Poniewa¿ algorytm ten jest niedeterministyczny, trudno oceniæ, jakie warto¶ci parametrów s± optymalne. Oczywi¶cie mo¿na dalej zmniejszaæ ich warto¶ci w poszukiwaniu lepszego wyniku.

Warto jednak zauwa¿yæ, jaka jest charakterystyka trasy otrzymanej tu jako najlepsze rozwi±zanie (o numerze próby 2). Tor jazdy jest po prostu ³aman±, której wierzcho³ki znajduj± siê w miejscach bramek - pomiêdzy kolejnymi bramkami linie s± w³a¶ciwie odcinkami co powoduje konieczno¶æ wykonywania bardzo ostrych skrêtów. Ten problem zostanie rozwi±zany w dalszej czê¶ci, w rozdziale \ref{sec:wynikiStrategieKarania} opisuj±cym wyniki zastosowania funkcji kary.

W trakcie szczegó³owej analizy wyników z kolejnych iteracji (widocznych na wykresach), ³atwo zauwa¿yæ, ¿e na pocz±tku poprawa wyników jest znacz±ca z ka¿d± iteracj±, a pod koniec zmiany s± ju¿ niewielkie. Mo¿na zatem pomy¶leæ o wprowadzeniu innego algorytmu, kiedy zmiany s± ju¿ s³abo widoczne, który skuteczniej znajdzie lepsze rozwi±zanie. Takim rozwi±zaniem jest na przyk³ad zastosowanie lokalnej optymalizacji. Wyniki tego podej¶cia opisane s± w sekcji \ref{sec:lokalnaWyniki}.

Zanim przejdziemy jednak do wyników wprowadzenia lokalnej optymalizacji omówione zostan± eksperymenty sprawdzaj±ce ostatnie parametry algorytmu ewolucyjnego: $\mu$ i $\lambda$, a nastêpnie pokazane zostanie rozwi±zanie trudniejszego zadania, uzyskanego poprzez zwiêkszenie liczby punktów stanowi±cych rozwi±zanie.

\subsubsection{Parametry $\mu$ i $\lambda$}
Do tej pory pocz±tkowa populacja liczy³a 30 osobników, a populacja tymczasowa - 100. W literaturze najczê¶ciej wymienia siê warto¶ci oko³o 50 i 200 \cite{arabas}, warto zatem spróbowaæ zwiêkszyæ te parametry, by sprawdziæ wiêcej przypadków rozwi±zañ. Pozosta³e parametry pozostaj± jak w poprzednim eksperymencie.

\paragraph{Eksperyment 1.}
W tym eksperymencie zosta³o sprawdzone jak wp³ywa na wyniki zmiana powy¿szych parametrów, na pocz±tek dla warto¶ci odpowiednio 50 i 150.

\begin{figure}[H]
\centering
\includegraphics[scale=0.9]{wyniki/wynik5-s}
\caption{Wyniki dla kolejnych prób eksperymentu dla parametrów $\mu=50$ i $\lambda=150$}
\label{fig:w5s}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[scale=0.7]{wyniki/wynik5-w}
\caption{Wykresy dla kolejnych prób eksperymentu dla parametrów $\mu=50$ i $\lambda=150$}
\label{fig:w5w}
\end{figure}

\begin{table}[h]
\caption{Czasy przejazdu dla kolejnych prób wraz z liczb± iteracji oraz czasem dzia³ania algorytmu ($\mu=50$ i $\lambda=150$)}
\centering
\label{tab:miLambda}
\begin{tabular}{ | c | c | c | c |}
  \hline                        
  numer próby & czas przejazdu [s] & liczba iteracji & czas dzia³ania [s] \\ \hline  
1 & 7.780 & 17 & 81 \\ \hline
2 & 7.814 & 21 & 109 \\ \hline
3 & 7.804 & 17 & 88 \\ \hline
\end{tabular}
\end{table}

¦rednia wyników podanych w tabeli \ref{tab:miLambda} wynosi: 7.799 s. W tym przypadku ¶rednio w ka¿dym eksperymencie zosta³o wykonanych oko³o 3670 symulacji.

Mo¿na siê by³o spodziewaæ poprawy wyników, jako, ¿e rozpatrywano naraz wiêcej osobników sprawdzaj±c wiêcej mo¿liwych rozwi±zañ, a wiêc zwiêkszaj±c prawdopodobieñstwo znalezienia lepszego rozwi±zania. Jednak poprawa jest niewielka, ale wa¿ne jest to, ¿e do tej pory nie uda³o nam siê uzyskaæ tak dobrego ¶redniego wyniku. To pokazuje, ¿e uda³o nam siê doprowadziæ do sytuacji, w której algorytm daje rzeczywi¶cie czê¶ciej lepsze wyniki, a uzyskane czasy s± zbli¿one do siebie.
Takie wyniki zosta³y poniesione kosztem czasu wykonania algorytmu, który wzrós³ do ponad 80 s, a w jednym przypadku nawet 110 s.


\paragraph{Eksperyment 2.}
W kolejnym eksperymencie sprawdzono jak zmieni± siê wyniki je¶li warto¶ci $\mu$ i $\lambda$ wynios± odpowiednio 60 i 200.

\begin{figure}[H]
\centering
\includegraphics[scale=0.6]{wyniki/wynik6-s}
\caption{Wyniki dla kolejnych prób eksperymentu dla parametrów $\mu=60$ i $\lambda=200$}
\label{fig:w6s}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{wyniki/wynik6-w}
\caption{Wykresy dla kolejnych prób eksperymentu dla parametrów $\mu=60$ i $\lambda=200$}
\label{fig:w6w}
\end{figure}

\begin{table}[h]
\caption{Czasy przejazdu dla kolejnych prób wraz z liczb± iteracji oraz czasem dzia³ania algorytmu ($\mu=60$ i $\lambda=200$)}
\centering
\begin{tabular}{ | c | c | c | c |}
  \hline                        
  numer próby & czas przejazdu [s] & liczba iteracji & czas dzia³ania [s] \\ \hline  
1 & 7.729 & 19 & 127 \\ \hline
2 & 7.783 & 15 & 118 \\ \hline
3 & 7.774 & 20 & 170 \\ \hline
\end{tabular}
\end{table}

¦rednia wyników wynosi: 7.762 s. ¦rednio w ka¿dym eksperymencie zosta³o wykonanych 4680 symulacji.

W tym przypadku wszystkie otrzymane czasy s± mniejsze ni¿ 7.8 s, a otrzymane linie przejazdu wygl±daj± bardzo dobrze. Warto równie¿ zauwa¿yæ, ¿e w pierwszym przypadku otrzymano najlepszy czas - 7.729 s. Widzimy równie¿, ¿e zgodnie z oczekiwaniami, wyd³u¿y³ siê znów czas dzia³ania algorytmu. Minimalny czas to 118 s, czyli oko³o 2 minuty, a wykonanie trwa³o maksymalnie prawie 3 minuty. Takie czasy ju¿ mo¿na uznaæ za wystarczaj±ce, aby warto by³o rozsy³aæ obliczenia, by by³y wykonywane na innych wêz³ach obliczeniowych.

Dla porównania przeanalizowano jak wp³ynê³y zmiany parametrów $\mu$ i $\lambda$ na uzyskiwane wyniki na podstawie danych z poprzednich eksperymentów. Uwzglêdniona jest tak¿e ¶rednia liczba symulacji koniecznych do osi±gniêcia wyniku dla ka¿dej pary ($\mu$ + $\lambda$).

\begin{figure}[h]
\centering
\includegraphics[scale=0.7]{wyniki/miLambda}
\caption{¦redni czas przejazdu z wykonanych prób dla ró¿nych parametrów $\mu$ i $\lambda$}
\label{fig:w6wyk}
\end{figure}

Wykres \ref{fig:w6wyk} pokazuje jak zmieni³ siê ¶redni czas uzyskanych wyników odpowiednio dla kolejnych warto¶ci parametrów $\mu$ i $\lambda$. Widaæ, ¿e choæ poprawa jest niewielka, bo o oko³o 0.05 s, to jednak widoczny jest trend wskazuj±cy, ¿e zwiêkszenie populacji wp³ywa pozytywnie na znajdowane rozwi±zanie. Poprawa jest lepsza w drugiej czê¶ci wykresu, bior±c pod uwagê jak zmienia siê liczba symulacji koniecznych do osi±gniêcia wyniku, w porównaniu z popraw± uzyskanego ¶redniego czasu przejazdu.

\subsubsection{Gêsto¶æ siatki}
Aby uzyskaæ dok³adniejsze rozwi±zania mo¿na spróbowaæ zagê¶ciæ poziome linie wyznaczaj±ce ilo¶æ punktów stanowi±cych reprezentacjê trasy. Do tej pory linie te by³y w odleg³o¶ci 3 m. Po zmianie na 2 m czas dzia³ania algorytmu powinien siê znacznie wyd³u¿yæ ze wzglêdu na wiêksz± liczbê rozpatrywanych punktów rozwi±zania.

W eksperymencie warto¶ci parametrów wynosz± dla warunku zakoñczenia: 
\begin{itemize}
\item dla zró¿nicowania populacji przyjêto warto¶æ 0.01, czyli 1\%,
\item zmiana najlepszego osobnika jest uznawana za wystarczaj±co du¿± je¶li wyniesie przynajmniej 0.05 s,
\item liczba iteracji, przez które czekamy na zmianê najlepszego osobnika - 10.
\end{itemize}

Natomiast parametry $\mu$ i $\lambda$ przyjmijmy 30 i 100.

Na rysunkach \ref{fig:w7s} oraz \ref{fig:w7w} przedstawione s± wyniki z trzech przeprowadzonych prób.

\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{wyniki/wynik7-w}
\caption{Wykresy dla kolejnych prób eksperymentu dla zwiêkszonej gêsto¶ci siatki punktów rozwi±zania}
\label{fig:w7w}
\end{figure}

\begin{figure}[h]
\centering
\includegraphics[scale=0.8]{wyniki/wynik7-s}
\caption{Wyniki dla kolejnych prób eksperymentu dla zwiêkszonej gêsto¶ci siatki punktów rozwi±zania}
\label{fig:w7s}
\end{figure}

Czas wykonania wyd³u¿y³ siê do 100-150 s, a liczba iteracji zwiêkszy³a siê do ok. 20. Mimo zwiêkszenia dok³adno¶ci, wci±¿ istniej± na trasie zbyt ostre zmiany kierunku, które w rzeczywisto¶ci s± niemo¿liwe do wykonania bez dodatkowego czasu oraz zmniejszenia prêdko¶ci - obliczona trasa jest zbyt ``kanciasta''. Wydaje siê, ¿e taki sposób optymalizacji nie umo¿liwia nam znalezienia rzeczywi¶cie najszybszej trasy. Zachodzi zatem konieczno¶æ wprowadzenia mechanizmu, który wyeliminuje zbyt ostre zmiany kierunku np. poprzez uwzglêdnienie konieczno¶ci zmniejszenia prêdko¶ci w miejscach o zbyt du¿ym k±cie za³amania. Szczegó³owo mechanizm ten opisany jest w sekcji \ref{sec:karanie} na stronie \pageref{sec:karanie}.

\subsubsection{D³uga trasa}
\label{dlugaTrasa}
Dotychczas rozpatrywany slalom by³ jedynie fragmentem standardowego slalomu, czas przejazdu wynosi³ mniej ni¿ 8 s. Pozostaje pytanie, czy dla wiêkszej liczby bramek algorytm nadal bêdzie w stanie znale¼æ rozwi±zanie zbli¿one do optymalnego oraz jak du¿o czasu bêdzie potrzebne do jego znalezienia. Mo¿liwe te¿, ¿e algorytm bêdzie potrzebowa³ zmiany parametrów, aby znale¼æ rozwi±zanie.

W tym eksperymencie sprawdzone zosta³o jakie wyniki otrzymamy dla d³u¿szego slalomu: (19,10), (11,30), (20,50), (12,65), (0,80), (10,100), (3,120), (6,135)). Parametry $\mu$ i $\lambda$ pozosta³y ustawione na 30 i 100. Parametry zatrzymania algorytmu zosta³y ustawione tak, aby algorytm dzia³a³ d³u¿ej:

\begin{itemize}
\item dla zró¿nicowania populacji przyjmujemy na warto¶æ 0.01, czyli 1\%,
\item zmiana najlepszego osobnika jest uznawana za wystarczaj±co du¿± je¶li wyniesie przynajmniej 0.05 s,
\item liczba iteracji, przez które czekamy na zmianê najlepszego osobnika - 10.
\end{itemize}

Kolejne punkty rozwi±zania znajduj± siê w odleg³o¶ci 3 m w pionie, co dla tej trasy daje 48 punktów do optymalizacji.

\begin{figure}[H]
\centering
\includegraphics[scale=0.9]{wyniki/wynik8-ws}
\caption{Uzyskany wynik wraz z wykresem dla eksperymentu na d³u¿szej trasie}
\label{fig:w8ws}
\end{figure}

Otrzymany wynik to 11.087 s. Obliczenia trwa³y 170 s, a algorytm potrzebowa³ 23 iteracje do zakoñczenia obliczeñ. Znów mo¿na powiedzieæ, ¿e wynik jest dobry, jednak na pewno móg³by byæ lepszy - istnieje wiele ostrych zakrêtów, zw³aszcza w okolicach bramek, rozwi±zanie nie jest idealne.

Warto zauwa¿yæ, ¿e wyd³u¿enie trasy nie spowodowa³o natomiast wiêkszych problemów je¶li chodzi o znalezienie trasy, mimo zastosowanych warunków zakoñczenia i zwiêkszenia liczby punktów z oko³o 30 na prawie 50.

\section{Lokalna optymalizacja}
\label{sec:lokalnaWyniki}
Algorytm ewolucyjny ma problem ze znalezieniem lepszych rozwi±zañ, zw³aszcza kiedy dotychczas znalezione rozwi±zanie daje ju¿ dosyæ dobry wynik, ale wci±¿ mo¿na go³ym okiem zobaczyæ miejsca, które negatywnie wp³ywaj± na jako¶æ wyniku. Skoro algorytm nie radzi sobie bêd±c blisko rozwi±zania, mo¿na spróbowaæ zastosowaæ algorytm memetyczny - bazuj±c na rozwi±zaniu znalezionym przez algorytm ewolucyjny, dokonujemy dalszej optymalizacji wykorzystuj±c algorytm lokalnej optymalizacji. Mamy wtedy pewno¶æ, ¿e znajdziemy rozwi±zanie nie gorsze od tego, na którym bazujemy i dodatkowo, ¿e bêdzie ono najlepszym lokalnym rozwi±zaniem. Mo¿emy mieæ tak¿e nadziejê, ¿e bêdzie to równie¿ rozwi±zanie globalnie optymalne.

\paragraph{Eksperyment 1.}
Bazuj±c na eksperymencie ``D³uga trasa'' w sekcji \ref{sec:ewolucyjnyWyniki} porównano jak poprawi siê otrzymany wynik dodaj±c na koniec obliczeñ optymalizacjê lokaln± algorytmem Hill climbing. Wszystkie parametry oraz trasa przejazdu pozosta³y takie same jak w eksperymencie, do którego siê odwo³ujemy.

\begin{figure}[h]
\centering
\includegraphics[scale=0.7]{wyniki/wynik9-wyk}
\caption{Wykres zmian czasu przejazdu w kolejnych iteracjach algorytmu HC}
\label{fig:w9wyk}
\end{figure}

\newpage
\begin{figure}[H]
\centering
\includegraphics[scale=0.9]{wyniki/wynik9-ws}
\caption{Porównanie wyników ES oraz HC wraz z wykresem dla eksperymentu na d³u¿szej trasie}
\label{fig:w9ws}
\end{figure}

Na wykresie \ref{fig:w9ws} znajduje siê porównanie wyniku algorytmu ewolucyjnego oraz lokalnej optymalizacji. Czarna linia trasy jest rezultatem otrzymanym po dzia³aniu samego algorytmu ewolucyjnego, czas przejazdu po takiej trasie wynosi 11.06 s, a wiêc jest to czas zbli¿ony do otrzymanego w eksperymencie bazowym. Algorytm ewolucyjny dzia³a³ przez 21 iteracji.

Czerwona linia stanowi trasê uzyskan± po zastosowaniu algorytmu optymalizacji lokalnej na trasie znalezionej przez algorytm ewolucyjny. Na wykresie \ref{fig:w9wyk} mo¿emy zobaczyæ jak dok³adnie zmienia³ siê czas przejazdu w ka¿dej iteracji algorytmu lokalnego. Iteracja numer 0 to wynik otrzymany przez algorytm genetyczny. Po 7 iteracjach otrzymali¶my wynik 10.825 s, co stanowi poprawê o 0.235 s, czyli ok. 2\%. Poprawa ta jest zdecydowanie zauwa¿alna tak¿e w kszta³cie slalomu i na pewno na tyle znacz±ca, ¿e decyduje o zwyciêstwie zawodnika.

\paragraph{Eksperyment 2.}
W eksperymencie pierwszym sprawdzili¶my dzia³anie algorytmu lokalnego dla domy¶lnie ustawionych parametrów. W zastosowanym algorytmie Hill Climbing istnieje mo¿liwo¶æ zmiany dwóch parametrów:

\begin{itemize}
\item rozmiaru kroku,
\item tzw. przyspieszenia (ang. \textit{acceleration}).
\end{itemize}

Szczegó³owy opis parametrów mo¿na znale¼æ w podrozdziale \ref{sec:hill}. W domy¶lnym ustawieniu warto¶ci tych parametrów wynosz± odpowiednio 0.5 (odpowiadaj±ca 0.5 metra na rzeczywistej trasie) oraz 1.2 dla przyspieszenia. W przeprowadzonym eksperymencie poka¿emy jak te parametry wp³ywaj± na ostateczne rozwi±zanie. Na tym samym rezultacie dzia³ania algorytmu genetycznego uruchomiony zostanie trzy razy algorytm lokalnej optymalizacji, ale z zestawami parametrów przedstawionymi w tabeli \ref{tab:paramHill}.

Jak zostanie pokazane w nastêpnym eksperymencie, stosowanie mechanizmu karania poprawia otrzymywane wyniki, wiêc ten sam eksperyment wykonamy tak¿e z zastosowaniem tego mechanizmu.

\begin{table}[h]
\caption{Warto¶ci parametrów algorytmu Hill climbing w kolejnych eksperymentach}
\centering
\label{tab:paramHill}
\begin{tabular}{ | c | c | c |}
  \hline                        
  nr próby & wielko¶æ kroku [m] & przyspieszenie \\ \hline  
  1 & 0.5 & 1.2 \\ \hline
  2 & 0.3 & 1.2 \\ \hline
  3 & 0.3 & 1.1 \\ \hline
\end{tabular}
\end{table}

\newpage
\begin{figure}[H]
\centering
\includegraphics[scale=0.8]{wyniki/wynik11-ws1}
\caption{Wyniki kolejnych prób eksperymentu z ró¿nymi warto¶ciami parametrów algorytmu HC}
\label{fig:w11ws}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[scale=0.8]{wyniki/wynik11-ws2}
\caption{Wyniki kolejnych prób eksperymentu z ró¿nymi warto¶ciami parametrów algorytmu HC z zastosowaniem PF}
\label{fig:w11ws2}
\end{figure}

Rysunki \ref{fig:w11ws} i \ref{fig:w11ws2} pokazuje otrzymane trasy dla ró¿nych algorytmów i parametrów:
\begin{itemize}
\item trasa czarna - trasa uzyskana w wyniki dzia³ania algorytmu ewolucyjnego,
\item trasa czerwona - optymalizacja lokalna z parametrami domy¶lnymi,
\item trasa niebieska - optymalizacja lokalna z krokiem 0.3 m,
\item trasa zielona - optymalizacja lokalna z krokiem 0.3 m oraz przyspieszeniem 1.1.
\end{itemize}

Trasy otrzymane w wyniku dzia³ania algorytmu optymalizacji lokalnej ró¿ni± siê miejscami od siebie, choæ w niewielkim stopniu. Ma³e zró¿nicowanie wynika z tego, ¿e pocz±tkowa trasa, któr± nale¿a³o zoptymalizowaæ by³a w ka¿dym przypadku taka sama. Algorytm Hill Climbing jest algorytmem deterministycznym, ale zmiana parametrów tego algorytmu wp³ywa na otrzymywany wynik koñcowy. W przypadku pierwszym, bez zastosowania mechanizmu karania zmiany s± minimalne, a otrzymywany wynik tak naprawdê mo¿na sprowadziæ do jazdy od bramki do bramki po liniach prostych. W drugim te¶cie wyniki ró¿ni± siê zw³aszcza w okolicach bramek, gdzie podejmowane s± decyzje o wcze¶niejszym lub pó¼niejszym skrêcie - to tam mo¿na najwiêcej zyskaæ lub straciæ.

Przeanalizujmy teraz dok³adniej otrzymane wyniki zebrane w tabelach \ref{tab:paramHillTab} oraz \ref{tab:paramHillTabPunish}.

Czas dzia³ania algorytmu ewolucyjnego w pierwszym przypadku to 181 s, w eksperymencie z karaniem 253 s. Czasy uzyskane w wyniku dzia³ania algorytmu ewolucyjnego w ka¿dej z prób wynosz± odpowiednio 10.974 s oraz 10.895 s.

\begin{table}[h]
\caption{Wyniki dla ró¿nych parametrów HC bez mechanizmu karania}
\centering
\label{tab:paramHillTab}
\begin{tabular}{ | c | c | c |}
  \hline                        
  nr & otrzymany czas przejazdu [s] & liczba iteracji\\ \hline  
  1 & 10.829 & 6 \\ \hline
  2 & 10.819 & 8 \\ \hline
  3 & 10.824 & 8 \\ \hline
\end{tabular}
\end{table}

\begin{table}[h]
\caption{Wyniki dla ró¿nych parametrów HC z PF}
\centering
\label{tab:paramHillTabPunish}
\begin{tabular}{ | c | c | c |}
  \hline                        
  nr &  otrzymany czas przejazdu [s] & liczba iteracji\\ \hline  
  1 & 11.036 & 11 \\ \hline
  2 & 11.050 & 14 \\ \hline
  3 & 11.024 & 10 \\ \hline
\end{tabular}
\end{table}

W pierwszej czê¶ci eksperymentu najlepszy czas uzyskany zosta³ dla drugiego przypadku, a wiêc przy zmniejszeniu wy³±cznie kroku. Poprawa w stosunku do pozosta³ych przypadków to 0.005-0.01 s czyli mniej ni¿ 0.1\%, ale widzimy, ¿e nawet tak niewielkie zmiany na trasie przejazdu mog± wp³ywaæ na koñcowy wynik.

Drugi przypadek jest trudniejszy do analizy, poniewa¿ wprowadzenie karania powoduje, ¿e nie jeste¶my w stanie przenie¶æ uzyskiwanych ocen do rzeczywisto¶ci. Wed³ug nich, znów najlepszy okazuje siê byæ zestaw parametrów z drugiego przypadku, kiedy jednak sprawdzimy w tabeli uzyskiwane czasy, widzimy, ¿e s± one gorsze ni¿ najlepszy uzyskany wynik z algorytmu ewolucyjnego, a w dodatku kolejno¶æ rezultatów nie pokrywa siê z kolejno¶ci± ocen - najlepszy czas uzyskany zosta³ w ostatnim przypadku.

Uzasadnieniem tego zachowania jest fakt uwzglêdniania w karaniu zbyt ostrych zakrêtów, które fizycznie nie s± mo¿liwe do wykonania lub musia³yby zabraæ dodatkowy czas. W rzeczywisto¶ci wyniki z pierwszego eksperymentu s± niemo¿liwe do otrzymania - przy ka¿dej bramce musieliby¶my straciæ dodatkowy czas na przestawienie nart w odpowiednim kierunku, co jest niemo¿liwe bez utraty prêdko¶ci.

\section{Strategie karania}
\label{sec:wynikiStrategieKarania}

Testowane zosta³y wszystkie opisane w rozdziale \ref{sec:karanie} na stronie \pageref{sec:karanie} strategie karania. Testy mia³y na celu zorientowanie siê czy wszystkie strategie bêd± przede wszystkim prowadziæ do poprawnego wyniku - tj. wizualnie poprawnej i p³ynnej trasy. Przy okazji sprawdzany by³ wp³yw kolejnych strategii karania na szybko¶æ zbie¿no¶ci algorytmu ewolucyjnego oraz lokalnej optymalizacji, a co za tym idzie do najszybszego znajdowania wyników. Dla ka¿dej testowanej strategii, ta sama strategia karania by³a u¿yta w algorytmie ewolucyjnym, jak i w lokalnej optymalizacji.

\subsubsection{Poprawno¶æ strategii}
\label{poprawnoscKarania}

\begin{figure}[h]
\centering
\includegraphics[height=300px]{punish-test}
\caption{Tor A przedstawia trasy obliczone przy u¿yciu strategii sumowania pochodnych, Tor B przy strategii zmniejszania wektorów, Tor C strategii karania za przekrawêdziowanie. Dla torów zarówno A, B i C  - czarny tor to wed³ug wprowadzonych wcze¶niej oznaczeñ ES + PF, czerwony tor to ES + HC + PF. Tor D przedstawia trasy bez zastosowania ¿adnej strategii karania  - czarny tor to ES, czerwony tor to ES + HC}
\label{fig:punishment}
\end{figure}

Rysunek \ref{fig:punishment} przedstawia znalezione tory przejazdu przy zastosowaniu ka¿dej z tych strategii. Jak widaæ, mo¿na dostrzec znacz±c± ró¿nicê w torach znalezionych przez algorytm ewolucyjny (czarna linia) w zale¿no¶ci od wyboru strategii. W przypadku lokalnej optymalizacji ró¿nice s± ju¿ mniejsze, jednak pierwsze dwie strategie wypadaj± w tym przypadku lepiej ni¿ pozosta³e, zw³aszcza na pierwszym odcinku trasy.

\subsubsection{Szybko¶æ obliczeñ}
\label{szybkoscObliczenKaranie}

Tabela \ref{tab:porownanieKarania} na stronie \pageref{tab:porownanieKarania} pokazuje ¶redni czas uzyskania wyniku dla ka¿dej ze strategii jak równie¿ dla braku zastosowania strategii. Najszybsz± zbie¿no¶æ maj± metody, które prowadz± do najgorszych jako¶ciowo rozwi±zañ (C i D z rysunku \ref{fig:punish}). Jak widaæ najszybsz± zbie¿no¶æ algorytmu ewolucyjnego uzyskuje siê dla karania poprzez zliczanie ilo¶ci przekrawêdziowañ. Ró¿nice pomiêdzy ¶rednimi szybko¶ciami s± znaczne, bo nawet czterokrotne. Zastosowanie strategii A prowadzi do uzyskania bardzo dobrego jako¶ciowo wyniku, dobrego do tego stopnia, ¿e lokalna optymalizacja nie wprowadza znacznej poprawy. Strategia B, nie do¶æ, ¿e prowadzi do bardzo dobrego wyniku jako¶ciowego, to zbiega siê do¶æ szybko w porównaniu ze strategi± A - o ponad 40\% szybciej.

\begin{table}[h] 
\caption{Porównanie d³ugo¶ci trwania obliczeñ instancji problemu dla u¿ytych ró¿nych strategii karania. Obliczenia prowadzone s± na maszynie o nastêpuj±cych parametrach: Procesor Intel Core i5-2410M, 2.3 GHz, 8 GB pamiêci RAM, System Windows 7 Home Premium, zminimalizowane obci±¿enie procesora przez inne procesy, obliczenia prowadzi jedna zak³adka przegl±darki Chrome}
\centering
\label{tab:porownanieKarania}
\begin{tabular}{|c|l|l|l|l|}
\hline
\multicolumn{1}{|l|}{}                                                                                         & \begin{tabular}[c]{@{}c@{}}Strategia 1 -\\sumowanie pochodnych\end{tabular} & \begin{tabular}[c]{@{}c@{}}Strategia 2 - \\ proporcjonalne \\ zmniejszanie\\  d³ugo¶ci wektora\end{tabular} & \begin{tabular}[c]{@{}c@{}}Strategia 3 - \\ zliczanie \\ przekrawêdziowania\end{tabular} & \begin{tabular}[c]{@{}c@{}}Strategia 4 - \\ brak karania\end{tabular} \\ \hline
\multirow{5}{*}{\begin{tabular}[c]{@{}c@{}}Czas rozwi±zania \\ kolejnego problemu \\ w sekundach\end{tabular}} 
& 91.272 &	48.241	& 18.798	& 31.264
   \\ \cline{2-5}  
\multicolumn{1}{|l|}{}                                                                                         
& 66.032 &	44.404	& 17.888	& 37.16
 \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                                                                                         & 117.033	& 54.362	& 20.441	& 27.404
 \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                                                                                         & 87.8	& 59.479	& 19.971	& 18.545 \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                                                                                         & 68.612	& 42.383	& 21.276	& 25.054 \\ \cline{2-5} 
                                                                         
\multicolumn{1}{|l|}{\textbf{¦redni czas rozwi±zania}}                                                         & \textbf{86.1498}                                                                                                       & \textbf{49.7738}                                                                                              & \textbf{19.6748}                                                                          & \textbf{27.8854}                                                        \\ \hline
\end{tabular}
\end{table}

\subsubsection{Wybór strategii}
\label{wyborStartegiiKarania}   
Rozwa¿aj±c wszystkie strategie, zosta³o przyjête, ¿e najlepszym modelem jest model ze strategi± proporcjonalnego zmniejszania d³ugo¶ci wektora prêdko¶ci w zale¿no¶ci od k±tów pomiêdzy kolejnymi odcinkami ³amanej - czyli Strategia B. Czas obliczeñ dla tej strategii nie jest ani najwiêkszy ani najmniejszy. Ta w³a¶nie strategia, jako najlepiej obrazuj±ca rzeczywisto¶æ i pozwalaj±ca na otrzymywanie najlepszych wyników, zosta³a wybrana jako mechanizm karania dla innych eksperymentów, chyba, ¿e jest to zaznaczone inaczej.
 
